board[row, col] <<- 0
}
}
return(FALSE)
}
board <- matrix(0, 9, 9)
solve_sudoku(board)
return(board)
}
# Generate and print the Sudoku board
sudoku_board <- generate_sudoku()
print_sudoku(sudoku_board)
# Load necessary library
library(grid)
# Function to print the Sudoku board with deeppink color
print_sudoku <- function(board) {
grid.newpage()
pushViewport(viewport(layout = grid.layout(9, 9)))
for (i in 1:9) {
for (j in 1:9) {
grid.text(board[i, j], x = (j - 0.5) / 9, y = (9 - i + 0.5) / 9, gp = gpar(fontsize = 15, col = "deeppink"))
}
}
for (i in 1:9) {
if (i %% 3 == 1) {
grid.lines(x = c(0, 1), y = c((9 - i + 1) / 9, (9 - i + 1) / 9), gp = gpar(lwd = 2, col = "deeppink"))
grid.lines(x = c((i - 1) / 9, (i - 1) / 9), y = c(0, 1), gp = gpar(lwd = 2, col = "deeppink"))
} else {
grid.lines(x = c(0, 1), y = c((9 - i + 1) / 9, (9 - i + 1) / 9), gp = gpar(col = "deeppink"))
grid.lines(x = c((i - 1) / 9, (i - 1) / 9), y = c(0, 1), gp = gpar(col = "deeppink"))
}
}
grid.lines(x = c(0, 1), y = c(0, 0), gp = gpar(lwd = 2, col = "deeppink"))
grid.lines(x = c(1, 1), y = c(0, 1), gp = gpar(lwd = 2, col = "deeppink"))
}
# Function to generate a valid Sudoku board
generate_sudoku <- function() {
solve_sudoku <- function(board) {
find_empty <- function(board) {
for (i in 1:9) {
for (j in 1:9) {
if (board[i, j] == 0) return(c(i, j))
}
}
return(NULL)
}
is_valid <- function(board, num, pos) {
for (i in 1:9) {
if (board[pos[1], i] == num && pos[2] != i) return(FALSE)
if (board[i, pos[2]] == num && pos[1] != i) return(FALSE)
}
box_x <- (pos[2] - 1) %/% 3
box_y <- (pos[1] - 1) %/% 3
for (i in 1:3) {
for (j in 1:3) {
if (board[box_y * 3 + i, box_x * 3 + j] == num && c(box_y * 3 + i, box_x * 3 + j) != pos) return(FALSE)
}
}
return(TRUE)
}
empty <- find_empty(board)
if (is.null(empty)) return(TRUE)
row <- empty[1]
col <- empty[2]
for (num in sample(1:9)) {
if (is_valid(board, num, c(row, col))) {
board[row, col] <<- num
if (solve_sudoku(board)) return(TRUE)
board[row, col] <<- 0
}
}
return(FALSE)
}
board <- matrix(0, 9, 9)
solved <- solve_sudoku(board)
if (!solved) {
stop("Failed to generate a Sudoku board.")
}
return(board)
}
# Generate and print the Sudoku board
sudoku_board <- generate_sudoku()
print(sudoku_board) # Print the board to check if it's generated correctly
# Load necessary library
library(grid)
# Function to print the Sudoku board with deeppink color
print_sudoku <- function(board) {
grid.newpage()
pushViewport(viewport(layout = grid.layout(9, 9)))
for (i in 1:9) {
for (j in 1:9) {
grid.text(board[i, j], x = (j - 0.5) / 9, y = (9 - i + 0.5) / 9, gp = gpar(fontsize = 15, col = "deeppink"))
}
}
for (i in 1:9) {
if (i %% 3 == 1) {
grid.lines(x = c(0, 1), y = c((9 - i + 1) / 9, (9 - i + 1) / 9), gp = gpar(lwd = 2, col = "deeppink"))
grid.lines(x = c((i - 1) / 9, (i - 1) / 9), y = c(0, 1), gp = gpar(lwd = 2, col = "deeppink"))
} else {
grid.lines(x = c(0, 1), y = c((9 - i + 1) / 9, (9 - i + 1) / 9), gp = gpar(col = "deeppink"))
grid.lines(x = c((i - 1) / 9, (i - 1) / 9), y = c(0, 1), gp = gpar(col = "deeppink"))
}
}
grid.lines(x = c(0, 1), y = c(0, 0), gp = gpar(lwd = 2, col = "deeppink"))
grid.lines(x = c(1, 1), y = c(0, 1), gp = gpar(lwd = 2, col = "deeppink"))
}
# Function to generate a valid Sudoku board
generate_sudoku <- function() {
solve_sudoku <- function(board) {
find_empty <- function(board) {
for (i in 1:9) {
for (j in 1:9) {
if (board[i, j] == 0) return(c(i, j))
}
}
return(NULL)
}
is_valid <- function(board, num, pos) {
for (i in 1:9) {
if (board[pos[1], i] == num && pos[2] != i) return(FALSE)
if (board[i, pos[2]] == num && pos[1] != i) return(FALSE)
}
box_x <- (pos[2] - 1) %/% 3
box_y <- (pos[1] - 1) %/% 3
for (i in 1:3) {
for (j in 1:3) {
if (board[box_y * 3 + i, box_x * 3 + j] == num && c(box_y * 3 + i, box_x * 3 + j) != pos) return(FALSE)
}
}
return(TRUE)
}
empty <- find_empty(board)
if (is.null(empty)) return(TRUE)
row <- empty[1]
col <- empty[2]
for (num in sample(1:9)) {
if (is_valid(board, num, c(row, col))) {
board[row, col] <<- num
if (solve_sudoku(board)) return(TRUE)
board[row, col] <<- 0
}
}
return(FALSE)
}
board <- matrix(0, 9, 9)
solved <- solve_sudoku(board)
if (!solved) {
stop("Failed to generate a Sudoku board.")
}
return(board)
}
# Generate and print the Sudoku board
sudoku_board <- generate_sudoku()
print(sudoku_board) # Print the board to check if it's generated correctly
View(print_sudoku)
# Load necessary library
library(grid)
# Function to print the Sudoku board with deeppink color
print_sudoku <- function(board) {
grid.newpage()
# Draw grid lines
for (i in 0:9) {
if (i %% 3 == 0) {
grid.lines(x = c(0, 1), y = c(i/9, i/9), gp = gpar(col = "deeppink", lwd = 2))
grid.lines(x = c(i/9, i/9), y = c(0, 1), gp = gpar(col = "deeppink", lwd = 2))
} else {
grid.lines(x = c(0, 1), y = c(i/9, i/9), gp = gpar(col = "deeppink", lwd = 1))
grid.lines(x = c(i/9, i/9), y = c(0, 1), gp = gpar(col = "deeppink", lwd = 1))
}
}
# Add numbers
for (i in 1:9) {
for (j in 1:9) {
if (board[i, j] != 0) {
grid.text(board[i, j], x = (j - 0.5) / 9, y = 1 - (i - 0.5) / 9, gp = gpar(fontsize = 15, col = "deeppink"))
}
}
}
}
# Function to generate a valid Sudoku board
generate_sudoku <- function() {
board <- matrix(0, 9, 9)
# A function to check if a number can be placed at a given position
is_valid <- function(board, num, row, col) {
for (i in 1:9) {
if (board[row, i] == num || board[i, col] == num) return(FALSE)
}
box_row <- (row - 1) %/% 3 * 3 + 1
box_col <- (col - 1) %/% 3 * 3 + 1
for (i in box_row:(box_row + 2)) {
for (j in box_col:(box_col + 2)) {
if (board[i, j] == num) return(FALSE)
}
}
return(TRUE)
}
# A function to solve the board using backtracking
solve_sudoku <- function(board) {
for (row in 1:9) {
for (col in 1:9) {
if (board[row, col] == 0) {
for (num in sample(1:9)) {
if (is_valid(board, num, row, col)) {
board[row, col] <<- num
if (solve_sudoku(board)) return(TRUE)
board[row, col] <<- 0
}
}
return(FALSE)
}
}
}
return(TRUE)
}
# Generate a completely solved Sudoku board
solve_sudoku(board)
return(board)
}
# Generate and print the Sudoku board
sudoku_board <- generate_sudoku()
print(sudoku_board) # Print the board to check if it's generated correctly
print_sudoku(sudoku_board)
# Function to generate a valid Sudoku board
generate_sudoku <- function() {
# Initialize an empty 9x9 Sudoku board
board <- matrix(0, nrow = 9, ncol = 9)
# Recursive function to fill the Sudoku board
fill_board <- function(board, row = 1, col = 1) {
if (row > 9) return(TRUE)  # Base case: the entire board is filled
next_row <- row + ifelse(col == 9, 1, 0)
next_col <- ifelse(col == 9, 1, col + 1)
# Randomly shuffle numbers 1 to 9 for each row and try placing them
for (num in sample(1:9)) {
if (is_valid(board, num, row, col)) {
board[row, col] <- num
if (fill_board(board, next_row, next_col)) return(TRUE)
board[row, col] <- 0
}
}
return(FALSE)
}
# Function to check if a number can be placed at a given position
is_valid <- function(board, num, row, col) {
# Check if the number is not already present in the same row, column, or 3x3 subgrid
return(!(num %in% board[row, ]) && !(num %in% board[ , col]) &&
!(num %in% board[((row - 1) %/% 3) * 3 + 1:3, ((col - 1) %/% 3) * 3 + 1:3]))
}
# Start filling the board
fill_board(board)
return(board)
}
# Generate a new Sudoku board
sudoku_board <- generate_sudoku()
# Print the Sudoku board
print_sudoku <- function(board) {
for (i in 1:9) {
for (j in 1:9) {
if (board[i, j] != 0) {
cat(board[i, j], " ", sep = "")
} else {
cat(". ", sep = "")
}
if (j %% 3 == 0 && j < 9) cat("| ")
}
cat("\n")
if (i %% 3 == 0 && i < 9) cat("------+-------+------\n")
}
}
# Print the generated Sudoku board
print_sudoku(sudoku_board)
q()
# Load necessary libraries
library(grid)
# Function to draw SpongeBob
draw_spongebob <- function() {
# Create a new plot
grid.newpage()
# Define colors
spongebob_color <- "yellow"  # SpongeBob's body color
eye_color <- "white"
pupil_color <- "black"
# Draw SpongeBob's body
grid.rect(x = 0.3, y = 0.3, width = 0.4, height = 0.4, gp = gpar(fill = spongebob_color))
# Calculate center position of SpongeBob's face
face_center_x <- 0.5
face_center_y <- 0.5
# Draw SpongeBob's eyes
grid.circle(x = face_center_x - 0.1, y = face_center_y, r = 0.05, gp = gpar(fill = eye_color))
grid.circle(x = face_center_x + 0.1, y = face_center_y, r = 0.05, gp = gpar(fill = eye_color))
# Draw SpongeBob's pupils
grid.circle(x = face_center_x - 0.1, y = face_center_y, r = 0.02, gp = gpar(fill = pupil_color))
grid.circle(x = face_center_x + 0.1, y = face_center_y, r = 0.02, gp = gpar(fill = pupil_color))
# Draw SpongeBob's mouth
grid.lines(x = c(face_center_x - 0.1, face_center_x + 0.1), y = c(face_center_y - 0.1, face_center_y - 0.1), gp = gpar(col = "black", lwd = 2))
}
# Draw SpongeBob
draw_spongebob()
q()
q()
h_numRos <- lmer(as.numeric(numRos.1) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
library(tidyverse)
library(RColorBrewer)
library(ggpubr)
library(lme4)
setwd("C:/Users/maial/Downloads/MBG REU/MOBOT_Physaria")
phy_tidy_data <- read_csv("data/physaria_buf_climate_data_20240717_l.csv")
phy_climate_data <- read_csv("data/physaria_buf_climate_data_20240717.csv")
phy_climate_data_uni <- phy_climate_data %>%
mutate(uni_MaternalLine = paste0(Site, as.character(MaternalLine)))
h_numRos <- lmer(as.numeric(numRos.1) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_numRos)
h_numRos_table <- as_tibble(VarCorr(h_numRos))
h_numRos_table$vcov[[1]]/sum(h_numRos_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_numRos_anova <- lm(as.numeric(numRos.1) ~ Site, data = phy_climate_data_uni)
site_numRos_anova
summary(site_numRos_anova)
anova(site_numRos_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_numRos_anova <- lm(as.numeric(numRos.1) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_numRos_anova)
anova(maternal_numRos_anova)
h_numStem <- lmer(as.numeric(numStem.1) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_numStem)
h_numStem_table <- as_tibble(VarCorr(h_numStem))
h_numStem_table$vcov[[1]]/sum(h_numStem_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_numStem_anova <- lm(as.numeric(numStem.1) ~ Site, data = phy_climate_data_uni)
site_numStem_anova
summary(site_numStem_anova)
anova(site_numStem_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_numStem_anova <- lm(as.numeric(numStem.1) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_numStem_anova)
anova(maternal_numStem_anova)
h_stemDia <- lmer(as.numeric(stemDia.1) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_stemDia)
h_stemDia_table <- as_tibble(VarCorr(h_stemDia))
h_stemDia_table$vcov[[1]]/sum(h_stemDia_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_stemDia_anova <- lm(as.numeric(stemDia.1) ~ Site, data = phy_climate_data_uni)
site_stemDia_anova
summary(site_stemDia_anova)
anova(site_stemDia_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_stemDia_anova <- lm(as.numeric(stemDia.1) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_stemDia_anova)
anova(maternal_stemDia_anova)
h_numLeaf <- lmer(as.numeric(numLeaf.1) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_numLeaf)
h_numLeaf_table <- as_tibble(VarCorr(h_numLeaf))
h_numLeaf_table$vcov[[1]]/sum(h_numLeaf_table$vcov)
h_stemLength <- lmer(as.numeric(stemLength.1) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_stemLength)
h_stemLength_table <- as_tibble(VarCorr(h_stemLength))
h_stemLength_table$vcov[[1]]/sum(h_stemLength_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_stemLength_anova <- lm(as.numeric(stemLength.1) ~ Site, data = phy_climate_data_uni)
site_stemLength_anova
summary(site_stemLength_anova)
anova(site_stemLength_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_stemLength_anova <- lm(as.numeric(stemLength.1) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_stemLength_anova)
anova(maternal_stemLength_anova)
h_numLeaf <- lmer(as.numeric(numLeaf.1) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_numLeaf)
h_numLeaf_table <- as_tibble(VarCorr(h_numLeaf))
h_numLeaf_table$vcov[[1]]/sum(h_numLeaf_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_numLeaf_anova <- lm(as.numeric(numLeaf.1) ~ Site, data = phy_climate_data_uni)
site_numLeaf_anova
summary(site_numLeaf_anova)
anova(site_numLeaf_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_numLeaf_anova <- lm(as.numeric(numLeaf.1) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_numLeaf_anova)
anova(maternal_numLeaf_anova)
h_leafWide <- lmer(as.numeric(leafWide.10) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_leafWide)
h_leafWide_table <- as_tibble(VarCorr(h_leafWide))
h_leafWide_table$vcov[[1]]/sum(h_leafWide_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_lfWide_anova <- lm(as.numeric(leafWide.10) ~ Site, data = phy_climate_data_uni)
site_lfWide_anova
summary(site_lfWide_anova)
anova(site_lfWide_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_lfWide_anova <- lm(as.numeric(leafWide.10) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_lfWide_anova)
anova(maternal_lfWide_anova)
## Use this for heritability
h_area <- lmer(leafArea.10 ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_area)
h_area_table <- as_tibble(VarCorr(h_area))
h_area_table$vcov[[1]]/sum(h_area_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_area_anova <- lm(leafArea.10 ~ Site, data = phy_climate_data_uni)
site_area_anova
summary(site_area_anova)
anova(site_area_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_area_anova <- lm(leafArea.10 ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_area_anova)
anova(maternal_area_anova)
## Use this for heritability
h_lflong <- lmer(as.numeric(leafLong.10) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_lflong)
h_lflong_table <- as_tibble(VarCorr(h_lflong))
h_lflong_table$vcov[[1]]/sum(h_lflong_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_lflong_anova <- lm(as.numeric(leafLong.10) ~ Site, data = phy_climate_data_uni)
site_lflong_anova
summary(site_lflong_anova)
anova(site_lflong_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_lflong_anova <- lm(as.numeric(leafLong.10) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_lflong_anova)
anova(maternal_lflong_anova)
h_numRos <- lmer(as.numeric(numRos.1) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_numRos)
h_numRos_table <- as_tibble(VarCorr(h_numRos))
h_numRos_table$vcov[[1]]/sum(h_numRos_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_numRos_anova <- lm(as.numeric(numRos.1) ~ Site, data = phy_climate_data_uni)
site_numRos_anova
summary(site_numRos_anova)
anova(site_numRos_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_numRos_anova <- lm(as.numeric(numRos.1) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_numRos_anova)
anova(maternal_numRos_anova)
h_numStem <- lmer(as.numeric(numStem.1) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_numStem)
h_numStem_table <- as_tibble(VarCorr(h_numStem))
h_numStem_table$vcov[[1]]/sum(h_numStem_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_numStem_anova <- lm(as.numeric(numStem.1) ~ Site, data = phy_climate_data_uni)
site_numStem_anova
summary(site_numStem_anova)
anova(site_numStem_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_numStem_anova <- lm(as.numeric(numStem.1) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_numStem_anova)
anova(maternal_numStem_anova)
h_stemDia <- lmer(as.numeric(stemDia.1) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_stemDia)
h_stemDia_table <- as_tibble(VarCorr(h_stemDia))
h_stemDia_table$vcov[[1]]/sum(h_stemDia_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_stemDia_anova <- lm(as.numeric(stemDia.1) ~ Site, data = phy_climate_data_uni)
site_stemDia_anova
summary(site_stemDia_anova)
anova(site_stemDia_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_stemDia_anova <- lm(as.numeric(stemDia.1) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_stemDia_anova)
anova(maternal_stemDia_anova)
h_stemLength <- lmer(as.numeric(stemLength.1) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_stemLength)
h_stemLength_table <- as_tibble(VarCorr(h_stemLength))
h_stemLength_table$vcov[[1]]/sum(h_stemLength_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_stemLength_anova <- lm(as.numeric(stemLength.1) ~ Site, data = phy_climate_data_uni)
site_stemLength_anova
summary(site_stemLength_anova)
anova(site_stemLength_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_stemLength_anova <- lm(as.numeric(stemLength.1) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_stemLength_anova)
anova(maternal_stemLength_anova)
h_numLeaf <- lmer(as.numeric(numLeaf.1) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_numLeaf)
h_numLeaf_table <- as_tibble(VarCorr(h_numLeaf))
h_numLeaf_table$vcov[[1]]/sum(h_numLeaf_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_numLeaf_anova <- lm(as.numeric(numLeaf.1) ~ Site, data = phy_climate_data_uni)
site_numLeaf_anova
summary(site_numLeaf_anova)
anova(site_numLeaf_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_numLeaf_anova <- lm(as.numeric(numLeaf.1) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_numLeaf_anova)
anova(maternal_numLeaf_anova)
h_leafWide <- lmer(as.numeric(leafWide.10) ~ (1|uni_MaternalLine), data = phy_climate_data_uni)
summary(h_leafWide)
h_leafWide_table <- as_tibble(VarCorr(h_leafWide))
h_leafWide_table$vcov[[1]]/sum(h_leafWide_table$vcov)
## Use this to investigate Site's effect on trait
## tell the model there are siblings. Samples are NOT independent from each others
site_lfWide_anova <- lm(as.numeric(leafWide.10) ~ Site, data = phy_climate_data_uni)
site_lfWide_anova
summary(site_lfWide_anova)
anova(site_lfWide_anova)
## Use this to investigate MaternalLine's effect on trait
maternal_lfWide_anova <- lm(as.numeric(leafWide.10) ~ uni_MaternalLine, data = phy_climate_data_uni)
summary(maternal_lfWide_anova)
anova(maternal_lfWide_anova)
source("C:/Users/maial/Downloads/MBG REU/MOBOT_Physaria/script/tidy_phy_data_maia_07092024.R")
